# ğŸš€ Cloudflare Pages å®Œæ•´éƒ¨ç½²æŒ‡å—

æœ¬æŒ‡å—è¯¦ç»†ä»‹ç»å¦‚ä½•å°†IPåœ°å€çº¯å‡€åº¦æ£€æŸ¥å·¥å…·éƒ¨ç½²åˆ°Cloudflare Pagesï¼ŒåŒ…æ‹¬Webç•Œé¢ã€å®šæ—¶ä»»åŠ¡å’Œè‡ªåŠ¨æ›´æ–°åŠŸèƒ½ã€‚

## ğŸ“‹ éƒ¨ç½²æ¶æ„æ¦‚è§ˆ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Cloudflare Pages  â”‚    â”‚ Cloudflare Workers  â”‚    â”‚   GitHub Actions    â”‚
â”‚                     â”‚    â”‚                     â”‚    â”‚                     â”‚
â”‚  â€¢ Webç•Œé¢          â”‚    â”‚  â€¢ å®šæ—¶ä»»åŠ¡         â”‚    â”‚  â€¢ è‡ªåŠ¨æ›´æ–°         â”‚
â”‚  â€¢ API Functions    â”‚    â”‚  â€¢ åå°å¤„ç†         â”‚    â”‚  â€¢ é…ç½®ä¿æŠ¤         â”‚
â”‚  â€¢ é™æ€èµ„æº         â”‚    â”‚  â€¢ KVå­˜å‚¨ç®¡ç†       â”‚    â”‚  â€¢ CI/CDæµç¨‹        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚                           â”‚                           â”‚
           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                       â”‚
                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                              â”‚     KV å­˜å‚¨         â”‚
                              â”‚                     â”‚
                              â”‚  â€¢ IPæ£€æµ‹ç¼“å­˜       â”‚
                              â”‚  â€¢ å®šæ—¶ä»»åŠ¡ç»“æœ     â”‚
                              â”‚  â€¢ é…ç½®æ•°æ®         â”‚
                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ¯ ä¸ºä»€ä¹ˆé€‰æ‹©Cloudflare Pagesï¼Ÿ

### æŠ€æœ¯ä¼˜åŠ¿
- **é›¶å†·å¯åŠ¨**: è¾¹ç¼˜è®¡ç®—ï¼Œæ¯«ç§’çº§å“åº”
- **å…¨çƒåˆ†å¸ƒ**: 200+è¾¹ç¼˜èŠ‚ç‚¹ï¼Œå°±è¿‘è®¿é—®
- **æ— æœåŠ¡å™¨**: æŒ‰éœ€è®¡è´¹ï¼Œè‡ªåŠ¨æ‰©ç¼©å®¹
- **é«˜å¯ç”¨æ€§**: 99.9%+ SLAä¿è¯

### æˆæœ¬ä¼˜åŠ¿
- **å…è´¹é¢åº¦**: 100,000è¯·æ±‚/å¤©ï¼Œè¶³å¤Ÿä¸ªäººä½¿ç”¨
- **æ— éšè—è´¹ç”¨**: è¶…å‡ºå…è´¹é¢åº¦æŒ‰é‡è®¡è´¹
- **KVå­˜å‚¨**: æ¯æœˆ1GBå…è´¹å­˜å‚¨

### åŠŸèƒ½ä¼˜åŠ¿
- **å®šæ—¶ä»»åŠ¡**: åŸç”ŸCronæ”¯æŒ
- **KVå­˜å‚¨**: æŒä¹…åŒ–æ•°æ®å­˜å‚¨
- **Functions**: è¾¹ç¼˜è®¡ç®—API
- **è‡ªåŠ¨éƒ¨ç½²**: Gité›†æˆï¼Œæ¨é€å³éƒ¨ç½²

## ğŸš€ å¿«é€Ÿéƒ¨ç½²

### æ–¹æ³•ä¸€ï¼šä¸€é”®éƒ¨ç½²ï¼ˆæ¨èï¼‰

1. **ç‚¹å‡»éƒ¨ç½²æŒ‰é’®**
   [![Deploy to Cloudflare Pages](https://deploy.workers.cloudflare.com/button)](https://deploy.workers.cloudflare.com/?url=https://github.com/twj0/ip-address-purity-checker)

2. **æˆæƒGitHub**
   - ç™»å½•æ‚¨çš„GitHubè´¦æˆ·
   - æˆæƒCloudflareè®¿é—®ä»“åº“

3. **é…ç½®é¡¹ç›®**
   - é¡¹ç›®åç§°: `ip-purity-checker`
   - ç”Ÿäº§åˆ†æ”¯: `main`
   - æ„å»ºå‘½ä»¤: ç•™ç©º
   - è¾“å‡ºç›®å½•: `public`

4. **ç­‰å¾…éƒ¨ç½²å®Œæˆ**
   - è‡ªåŠ¨åˆ›å»ºKVå‘½åç©ºé—´
   - éƒ¨ç½²Pageså’ŒWorkers
   - é…ç½®åŸŸåå’ŒSSL

### æ–¹æ³•äºŒï¼šæ‰‹åŠ¨éƒ¨ç½²

#### å‰ç½®è¦æ±‚
- Node.js 18+
- Git
- Cloudflareè´¦æˆ·

#### æ­¥éª¤è¯¦è§£

1. **Forkä»“åº“**
   ```bash
   # åœ¨GitHubä¸ŠForkä»“åº“
   # https://github.com/twj0/ip-address-purity-checker
   ```

2. **å…‹éš†åˆ°æœ¬åœ°**
   ```bash
   git clone https://github.com/YOUR_USERNAME/ip-address-purity-checker.git
   cd ip-address-purity-checker
   ```

3. **å®‰è£…Wrangler CLI**
   ```bash
   npm install -g wrangler
   wrangler login
   ```

4. **è¿è¡Œéƒ¨ç½²è„šæœ¬**
   ```bash
   chmod +x scripts/deploy-cloudflare.sh
   ./scripts/deploy-cloudflare.sh
   ```

5. **é…ç½®APIå¯†é’¥**
   ```bash
   # ProxyCheck.io APIå¯†é’¥ï¼ˆæ¨èï¼‰
   wrangler secret put PROXYCHECK_API_KEY
   
   # IPinfo.io Tokenï¼ˆå¤‡ç”¨ï¼‰
   wrangler secret put IPINFO_TOKEN
   ```

## âš™ï¸ è¯¦ç»†é…ç½®

### KVå‘½åç©ºé—´é…ç½®

KVå­˜å‚¨ç”¨äºç¼“å­˜IPæ£€æµ‹ç»“æœå’Œä¿å­˜å®šæ—¶ä»»åŠ¡æ•°æ®ï¼š

```toml
# wrangler.toml
[[kv_namespaces]]
binding = "IP_CACHE"
id = "your-kv-namespace-id"
preview_id = "your-preview-kv-namespace-id"
```

**åˆ›å»ºKVå‘½åç©ºé—´ï¼š**
```bash
# ç”Ÿäº§ç¯å¢ƒ
wrangler kv:namespace create "IP_CACHE"

# é¢„è§ˆç¯å¢ƒ
wrangler kv:namespace create "IP_CACHE" --preview
```

### ç¯å¢ƒå˜é‡é…ç½®

æ”¯æŒçš„ç¯å¢ƒå˜é‡ï¼š

| å˜é‡å | è¯´æ˜ | å¿…éœ€ | ç¤ºä¾‹ |
|--------|------|------|------|
| `PROXYCHECK_API_KEY` | ProxyCheck.io APIå¯†é’¥ | æ¨è | `abc123...` |
| `IPINFO_TOKEN` | IPinfo.ioè®¿é—®ä»¤ç‰Œ | å¯é€‰ | `def456...` |
| `SUBSCRIPTION_URLS` | è‡ªå®šä¹‰è®¢é˜…é“¾æ¥ | å¯é€‰ | `["url1","url2"]` |
| `ENVIRONMENT` | ç¯å¢ƒæ ‡è¯† | è‡ªåŠ¨ | `production` |

**è®¾ç½®ç¯å¢ƒå˜é‡ï¼š**
```bash
# é€šè¿‡Wrangler CLI
wrangler secret put PROXYCHECK_API_KEY

# é€šè¿‡Cloudflare Dashboard
# è¿›å…¥Workers & Pages > é€‰æ‹©é¡¹ç›® > Settings > Environment variables
```

### å®šæ—¶ä»»åŠ¡é…ç½®

å®šæ—¶ä»»åŠ¡é…ç½®åœ¨ `wrangler.toml` ä¸­ï¼š

```toml
# æ¯æ—¥UTC 16:00æ‰§è¡Œï¼ˆåŒ—äº¬æ—¶é—´00:00ï¼‰
[[triggers]]
crons = ["0 16 * * *"]
```

**å¸¸ç”¨Cronè¡¨è¾¾å¼ï¼š**
- `0 16 * * *` - æ¯æ—¥UTC 16:00
- `0 */6 * * *` - æ¯6å°æ—¶æ‰§è¡Œä¸€æ¬¡
- `0 8,20 * * *` - æ¯æ—¥UTC 8:00å’Œ20:00

### è‡ªå®šä¹‰åŸŸåé…ç½®

1. **åœ¨Cloudflare Dashboardä¸­**
   - è¿›å…¥ Pages > é¡¹ç›®è®¾ç½®
   - ç‚¹å‡» "Custom domains"
   - æ·»åŠ æ‚¨çš„åŸŸå

2. **DNSé…ç½®**
   ```
   CNAME  your-domain.com  ip-purity-checker.pages.dev
   ```

## ğŸ”§ é«˜çº§é…ç½®

### æ€§èƒ½ä¼˜åŒ–

#### ç¼“å­˜ç­–ç•¥
```javascript
// functions/api/check-ip.js
const CACHE_TTL = {
  IP_RESULT: 3600,      // IPæ£€æµ‹ç»“æœç¼“å­˜1å°æ—¶
  SUBSCRIPTION: 86400,   // è®¢é˜…è§£æç¼“å­˜24å°æ—¶
  ERROR: 300            // é”™è¯¯ç»“æœç¼“å­˜5åˆ†é’Ÿ
};
```

#### å¹¶å‘æ§åˆ¶
```javascript
// é™åˆ¶å¹¶å‘è¯·æ±‚æ•°é¿å…é€Ÿç‡é™åˆ¶
const MAX_CONCURRENT = 5;
const BATCH_DELAY = 1000; // 1ç§’å»¶è¿Ÿ
```

### ç›‘æ§å’Œæ—¥å¿—

#### å®æ—¶æ—¥å¿—
```bash
# æŸ¥çœ‹Workerå®æ—¶æ—¥å¿—
wrangler tail

# æŸ¥çœ‹ç‰¹å®šæ—¶é—´æ®µæ—¥å¿—
wrangler tail --since 1h
```

#### æ€§èƒ½ç›‘æ§
- Cloudflare Analytics
- Worker Analytics
- Pages Analytics

### å®‰å…¨é…ç½®

#### APIå¯†é’¥ä¿æŠ¤
- ä½¿ç”¨Wrangler Secretså­˜å‚¨æ•æ„Ÿä¿¡æ¯
- ä¸è¦åœ¨ä»£ç ä¸­ç¡¬ç¼–ç å¯†é’¥
- å®šæœŸè½®æ¢APIå¯†é’¥

#### CORSé…ç½®
```javascript
const corsHeaders = {
  'Access-Control-Allow-Origin': '*',
  'Access-Control-Allow-Methods': 'GET, POST, OPTIONS',
  'Access-Control-Allow-Headers': 'Content-Type, X-ProxyCheck-Key'
};
```

## ğŸ”„ è‡ªåŠ¨æ›´æ–°é…ç½®

### GitHub Actionsè®¾ç½®

Forkä»“åº“åè‡ªåŠ¨è·å¾—è‡ªåŠ¨æ›´æ–°åŠŸèƒ½ï¼š

1. **è‡ªåŠ¨åŒæ­¥**: æ¯æ—¥æ£€æŸ¥ä¸Šæ¸¸æ›´æ–°
2. **é…ç½®ä¿æŠ¤**: ä¿ç•™ä¸ªäººé…ç½®ä¸è¢«è¦†ç›–
3. **æ™ºèƒ½åˆå¹¶**: è‡ªåŠ¨è§£å†³å¤§éƒ¨åˆ†å†²çª
4. **æ‰‹åŠ¨è§¦å‘**: æ”¯æŒæ‰‹åŠ¨è§¦å‘æ›´æ–°

### é…ç½®ä¿æŠ¤æœºåˆ¶

è‡ªåŠ¨æ›´æ–°ä¼šä¿æŠ¤ä»¥ä¸‹é…ç½®ï¼š
- KVå‘½åç©ºé—´ID
- APIå¯†é’¥å’ŒToken
- è‡ªå®šä¹‰è®¢é˜…é“¾æ¥
- wrangler.tomlä¸ªäººé…ç½®
- ç¯å¢ƒå˜é‡è®¾ç½®

### æ‰‹åŠ¨è§¦å‘æ›´æ–°

```bash
# åœ¨GitHubä»“åº“é¡µé¢
# Actions > Auto Update Fork > Run workflow
```

## ğŸ› æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

#### 1. éƒ¨ç½²å¤±è´¥ï¼šæƒé™é”™è¯¯
```bash
# é‡æ–°ç™»å½•Cloudflare
wrangler logout
wrangler login
```

#### 2. KVå‘½åç©ºé—´é”™è¯¯
```bash
# æ£€æŸ¥KVå‘½åç©ºé—´
wrangler kv:namespace list

# é‡æ–°åˆ›å»º
wrangler kv:namespace create "IP_CACHE"
```

#### 3. APIæ£€æµ‹å¤±è´¥
- æ£€æŸ¥APIå¯†é’¥é…ç½®
- ç¡®è®¤ç½‘ç»œè¿æ¥
- æŸ¥çœ‹Workeræ—¥å¿—

#### 4. å®šæ—¶ä»»åŠ¡ä¸æ‰§è¡Œ
```bash
# æ£€æŸ¥croné…ç½®
wrangler cron trigger --cron "0 16 * * *"

# æŸ¥çœ‹è§¦å‘å™¨çŠ¶æ€
wrangler triggers list
```

### è°ƒè¯•æŠ€å·§

#### æœ¬åœ°å¼€å‘
```bash
# å¯åŠ¨æœ¬åœ°å¼€å‘æœåŠ¡å™¨
wrangler dev

# æµ‹è¯•ç‰¹å®šå‡½æ•°
wrangler dev --local
```

#### æ—¥å¿—åˆ†æ
```bash
# å®æ—¶æ—¥å¿—
wrangler tail --format pretty

# è¿‡æ»¤é”™è¯¯æ—¥å¿—
wrangler tail --status error
```

#### KVå­˜å‚¨è°ƒè¯•
```bash
# åˆ—å‡ºæ‰€æœ‰é”®
wrangler kv:key list --binding IP_CACHE

# æŸ¥çœ‹ç‰¹å®šé”®å€¼
wrangler kv:key get "ip:8.8.8.8" --binding IP_CACHE

# åˆ é™¤é”®å€¼
wrangler kv:key delete "ip:8.8.8.8" --binding IP_CACHE
```

## ğŸ“Š æ€§èƒ½ç›‘æ§

### å…³é”®æŒ‡æ ‡

- **å“åº”æ—¶é—´**: < 200ms (å…¨çƒå¹³å‡)
- **æˆåŠŸç‡**: > 99.5%
- **ç¼“å­˜å‘½ä¸­ç‡**: > 80%
- **APIè°ƒç”¨æˆåŠŸç‡**: > 95%

### ç›‘æ§å·¥å…·

1. **Cloudflare Analytics**
   - è¯·æ±‚é‡ç»Ÿè®¡
   - å“åº”æ—¶é—´åˆ†æ
   - é”™è¯¯ç‡ç›‘æ§

2. **Worker Analytics**
   - CPUä½¿ç”¨æ—¶é—´
   - å†…å­˜ä½¿ç”¨æƒ…å†µ
   - æ‰§è¡Œæ¬¡æ•°ç»Ÿè®¡

3. **è‡ªå®šä¹‰ç›‘æ§**
   ```javascript
   // åœ¨Workerä¸­æ·»åŠ è‡ªå®šä¹‰æŒ‡æ ‡
   console.log(JSON.stringify({
     timestamp: Date.now(),
     ip: ip,
     response_time: responseTime,
     cache_hit: cacheHit
   }));
   ```

## ğŸ¯ æœ€ä½³å®è·µ

### å¼€å‘æµç¨‹
1. æœ¬åœ°å¼€å‘å’Œæµ‹è¯•
2. æäº¤åˆ°GitHub
3. è‡ªåŠ¨éƒ¨ç½²åˆ°é¢„è§ˆç¯å¢ƒ
4. æµ‹è¯•é€šè¿‡ååˆå¹¶åˆ°ä¸»åˆ†æ”¯
5. è‡ªåŠ¨éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒ

### é…ç½®ç®¡ç†
- ä½¿ç”¨ç¯å¢ƒå˜é‡ç®¡ç†é…ç½®
- æ•æ„Ÿä¿¡æ¯ä½¿ç”¨Secrets
- ç‰ˆæœ¬æ§åˆ¶é…ç½®æ–‡ä»¶

### ç›‘æ§å’Œç»´æŠ¤
- å®šæœŸæ£€æŸ¥æ—¥å¿—
- ç›‘æ§APIä½¿ç”¨é‡
- åŠæ—¶æ›´æ–°ä¾èµ–

---

ğŸ‰ **ç°åœ¨æ‚¨å·²ç»æŒæ¡äº†Cloudflare Pagesçš„å®Œæ•´éƒ¨ç½²æµç¨‹ï¼äº«å—é«˜æ€§èƒ½çš„IPçº¯å‡€åº¦æ£€æµ‹æœåŠ¡å§ï¼**
